<% id = "#{dynamic_object_id('teaching_unit', f)}_#{teaching_unit.new_record? ? 'NEW_RECORD' : teaching_unit.id}" %>
<div class="teaching_unit item" id="<%= id %>">
  <div class="row">
    <div class="col-md-4">
      <% if teaching_unit.new_record? %>
         <%= hidden_field_tag 'subtopic[teaching_unit_ids][]', teaching_unit.id,
           id: "hidden_teaching_unit_#{id}", class: :autocomplete_id %>
         <div class="search">
          <%= f.input :nested_teaching_unit, as: :string, label: false,
            input_html: {
              autofocus: true,
              id: "subtopic_teaching_unit_#{id}", class: :autocomplete_field,
              value: teaching_unit.title,
              data: {
                'autocomplete-url' => autocomplete_for_teaching_unit_subtopics_path(format: :json),
                params: ({ subject_id: @subtopic.id}.to_json unless @subtopic.new_record?),
              }
            } %>
        </div>
      <% else %>
        <p><strong><%= teaching_unit.title %></strong></p>
        <%= hidden_field_tag 'subtopic[teaching_unit_ids][]', teaching_unit.id,
          id: "hidden_teaching_unit_#{id}" %>
      <% end %>
    </div>

    <div class="col-md-4">
      <%= remove_list_item_link(nil, 'teaching_unit') %>
    </div>
  </div>
</div>
<% if teaching_unit.new_record? %>
  <script type="text/javascript">
    $('#<%= "subtopic_teaching_unit_#{id}" %>').focus();
  </script>
<% end %>
